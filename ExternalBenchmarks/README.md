# ExternalBenchmarks

Additional CRDT benchmarks that utilize https://github.com/ordo-one/package-benchmark.

This code is explicitly in a subdirectory with a local reference to CRDT in order
to preserve the backwards compatibility of the CRDT package itself, where this
benchmark library requires macOS 13 (or Linux).

There are multiple sets of benchmarks included, exploring a few different avenues - speed of JSON loading,
CRDT list creation, etc. Uncomment the ones you're interested in exploring and run 'em.

To run the benchmarks, invoke:

        swift package benchmark --grouping metric --format markdown

## Baseline `9ad6336d2bbc`

```
Host 'MacBookPro' with 8 'arm64' processors with 16 GB memory, running:
Darwin Kernel Version 24.0.0: Tue Sep 24 23:36:26 PDT 2024; root:xnu-11215.1.12~1/RELEASE_ARM64_T8103
```
### Malloc (total)

```
╒════════════════════════════════════════════════════════════════════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╕
│ Test                                                                   │       p0 │      p25 │      p50 │      p75 │      p90 │      p99 │     p100 │  Samples │
╞════════════════════════════════════════════════════════════════════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╡
│ ExternalBenchmarks:Create single-character List CRDT                   │     4000 │     4000 │     4000 │     4000 │     4000 │     4000 │     4000 │      998 │
├────────────────────────────────────────────────────────────────────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ ExternalBenchmarks:List six-character append                           │        2 │        2 │        2 │        2 │        2 │        2 │        2 │    35000 │
├────────────────────────────────────────────────────────────────────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ ExternalBenchmarks:List six-character append, individual characters    │        9 │        9 │        9 │        9 │        9 │        9 │        9 │    30000 │
╘════════════════════════════════════════════════════════════════════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╛

```
### Memory (resident peak)

```
╒════════════════════════════════════════════════════════════════════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╕
│ Test                                                                   │       p0 │      p25 │      p50 │      p75 │      p90 │      p99 │     p100 │  Samples │
╞════════════════════════════════════════════════════════════════════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╡
│ ExternalBenchmarks:Create single-character List CRDT (K)               │     7716 │     7753 │     7766 │     7766 │     7766 │     7766 │     7766 │      998 │
├────────────────────────────────────────────────────────────────────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ ExternalBenchmarks:List six-character append (K)                       │     7733 │     7770 │     7770 │     7782 │     7782 │     7782 │     7782 │    35000 │
├────────────────────────────────────────────────────────────────────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ ExternalBenchmarks:List six-character append, individual characters (… │     7716 │     7753 │     7766 │     7766 │     7766 │     7766 │     7766 │    30000 │
╘════════════════════════════════════════════════════════════════════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╛

```
### Throughput (# / s)

```
╒════════════════════════════════════════════════════════════════════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╕
│ Test                                                                   │       p0 │      p25 │      p50 │      p75 │      p90 │      p99 │     p100 │  Samples │
╞════════════════════════════════════════════════════════════════════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╡
│ ExternalBenchmarks:Create single-character List CRDT                   │     1059 │     1041 │     1022 │     1018 │     1003 │      929 │      887 │      998 │
├────────────────────────────────────────────────────────────────────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ ExternalBenchmarks:List six-character append (K)                       │      521 │      489 │      489 │      489 │      480 │      461 │       37 │    35000 │
├────────────────────────────────────────────────────────────────────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ ExternalBenchmarks:List six-character append, individual characters (… │      193 │      163 │      162 │      162 │      161 │      156 │       31 │    30000 │
╘════════════════════════════════════════════════════════════════════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╛

```
### Time (total CPU)

```
╒════════════════════════════════════════════════════════════════════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╕
│ Test                                                                   │       p0 │      p25 │      p50 │      p75 │      p90 │      p99 │     p100 │  Samples │
╞════════════════════════════════════════════════════════════════════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╡
│ ExternalBenchmarks:Create single-character List CRDT (μs)              │      944 │      961 │      978 │      983 │      997 │     1073 │     1101 │      998 │
├────────────────────────────────────────────────────────────────────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ ExternalBenchmarks:List six-character append (μs)                      │        2 │        2 │        2 │        2 │        2 │        2 │       26 │    35000 │
├────────────────────────────────────────────────────────────────────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ ExternalBenchmarks:List six-character append, individual characters (… │        5 │        6 │        6 │        6 │        6 │        6 │       32 │    30000 │
╘════════════════════════════════════════════════════════════════════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╛

```
### Time (wall clock)

```
╒════════════════════════════════════════════════════════════════════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╕
│ Test                                                                   │       p0 │      p25 │      p50 │      p75 │      p90 │      p99 │     p100 │  Samples │
╞════════════════════════════════════════════════════════════════════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╡
│ ExternalBenchmarks:Create single-character List CRDT (μs)              │      943 │      960 │      978 │      982 │      997 │     1077 │     1127 │      998 │
├────────────────────────────────────────────────────────────────────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ ExternalBenchmarks:List six-character append (μs)                      │        1 │        2 │        2 │        2 │        2 │        2 │       26 │    35000 │
├────────────────────────────────────────────────────────────────────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┼──────────┤
│ ExternalBenchmarks:List six-character append, individual characters (… │        5 │        6 │        6 │        6 │        6 │        6 │       31 │    30000 │
╘════════════════════════════════════════════════════════════════════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╛

```
